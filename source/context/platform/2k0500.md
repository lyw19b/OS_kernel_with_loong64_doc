# 2k0500芯片

龙芯 2K0500 芯片，广泛应用于嵌入式系统领域。

具体请查看手册:[龙芯 2K0500 处理器用户手册 V1.0](https://www.loongson.cn/uploads/images/2023042109171499358.%E9%BE%99%E8%8A%AF2K0500%E5%A4%84%E7%90%86%E5%99%A8%E7%94%A8%E6%88%B7%E6%89%8B%E5%86%8C_v1.0.pdf)。


## 芯片架构

其基本性能参数如下。

:::{list-table} 
:widths: 20 50
:header-rows: 0

*	- 处理器核
	- 64 位双发射超标量 LA264 ，支持 LoongArch 指令系统
*	- 主频
	- 500 MHz～ 800 MHz
*	- 功耗
	- 1 ~ 3 W，支持动态降频降压
*	- 高速缓存
	- 32KB 一级指令缓存和 32KB 一级数据缓存；512KB 二级共享缓存
*	- 内存控制器
	- 32 位 DDR2/3-1066 控制器
*	- 高速 I/O
	- PCIE 2.0 * 2、SATA 2.0 * 2、USB 3.0
*	- 其他接口
	- DVO、PCI、GMAC、USB2.0、NAND、SPI、LPC、LIO、I2C、PRINT、AC97、HDA、UART、SDIO、CAN、PS/2、PWM、GPIO
:::

##	芯片架构

龙芯 2K0500 芯片结构图如下。

## 芯片架构

龙芯 2K0500 芯片结构图如下。

```{image} ../../img/arch_2k0500.png
:alt: 2K0500 结构图
:class: bg-primary
:scale: 50 %
:align: center
```

## 芯片功能

1. 处理器核
-	LA264
-	LoongArch 体系结构兼容
-	包括 1 个全流水的 64 位双精度浮点乘加部件
-	32KB 数据 Cache 和 32KB 的指令 Cache
-	512KB 共享二级 Cache
-	通过目录协议维护 I/O DMA 访问的 Cache 一致性
-	JTAG 支持
-	DVFS 支持
2. 内存接口
-	32 位 DDR3 控制器，最高工作频率 533 MHz
-	不支持 ECC
-	可配置为 32/16 位模式
-	支持命令调度
3.	GPU
-	动态电源管理
-	支持 Bit BLT 和Stretch BLT
-	矩形填充
-	硬件画线
-	单色字体渲染
-	ROP2 ，ROP3 ，ROP4
-	Alpha 混合
-	32K x 32K 坐标系统
-	90 度旋转
-	透明支持
-	YUV 色域空间转换
-	高质量缩放
4. 显示控制器
-	双输出显示 DVO/VGA
-	硬件光标
-	伽玛校正
-	输出抖动
-	最高像素时钟 DVO 164 MHz 1080p
-	支持线性显示缓冲
-	上电序列控制
5.	PCIE 接口
-	兼容 PCIE 2.0
-	双独立 X1 接口
-	双接口均支持 RC/EP
6.	SATA控制器
-	2 个独立 SATA 端口
-	支持 SATA 1.5Gbps 和 SATA 2 代 3Gbps 传输
7.	PCI 接口
-	兼容 PCI 2.2 ，32位总线宽度
-	既可以做 Host(SoC)，又可以做 Device(南桥)
-	作为 Host 最多支持 2 个 PCI 设备
-	作为 Device 时有三个 PCI 地址窗口: IO、Memory、Prefetchable Memory
8.	USB 控制器
-	4 个独立 USB 2.0 的 HOST 端口，端口 0 可配置为 OTG 模式
-	1 个独立 USB 3.0 接口，支持 OTG 模式
-	内部 EHCI 控制和实现高速传输
-	内部 OHCI 控制和实现全速和低速传输
9.	GMAC 控制器
-	两路 10/100/1000 Mbps 自适应以太网 MAC
-	双网卡均兼容 IEEE 802.3
-	对外部 PHY 实现 RGMII 接口
-	半双工/全双工自适应
-	Timestamp 功能
-	半双工时，支持碰撞检测与重发 (CSMA/CD) 协议
-	支持 CRC 校验码的自动生成与校验，支持前置符生成与删除
10.	LPC控制器
-	兼容 LPC Rev 1.1 标准
-	支持系统启动
-	支持主、从模式(从模式仅支持从 RAM 存储)
11.	AC97 控制器
-	支持 16、18 和 20 位采样精度、支持可变速率
-	最高达 48 KHz
-	2 频道立体声输出
-	支持麦克风输入
12.	HDA 控制器
-	支持 16、18 和 20 位采样精度、支持可变速率
-	最高达 192 KHz
-	7.1 频道环绕立体声输出
-	1 路音频输入
13.	NAND 控制器
-	最大支持单片 16GB NAND Flash
-	最大支持 4 个片选
-	支持 MLC
-	支持系统启动
-	支持 512 / 2K / 4K / 8K 页
14.	SPI 控制器
-	双缓冲接收器
-	极性和相位可变成的串行时钟
-	主模式支持
-	支持到 4 个的变长字节传输
-	支持系统启动( 仅 SPIO )
-	支持标准读、连续地址读、快速读、双路 I/O 等 SPI Flash 读模式
15.	UART
-	2 个全功能 UART 和流控 TXD,RXD,CTS, RTS, DSR,DTR,DCD, RI
-	最多 10 个 UART 接口
-	在寄存器与功能上兼容 NS16550A
-	两路全双工异步数据接收/发送
-	可编程的数据格式
-	16 位可编程时钟计数器
-	支持接收超时检测
-	带仲裁的多中断系统
16. I2C 总线
-	与 PHILIPS I2C 标准相兼容
-	履行双向同步串行协议
-	实现主/从设备操作
-	能够支持多主设备的总线
-	总线的时钟频率可编程
-	可以产生开始/停止/应答等操作
-	能够对总线的状态进行探测
-	支持低速和快速模式
-	支持 7 位寻址和 10 位寻址
-	支持时钟延伸和等待状态
17. 打印接口
-	支持 JBIG 85 解码
-	支持 8 路独立机芯控制
-	支持四色彩打功能
18.	PWM
-	32 位计数器
-	支持脉冲生成及捕获
-	16 路控制器
19.	SDIO 控制器
-	2 路独立 SDIO 控制器
-	兼容 SD Memory 2.0/MMC/SDIO 2.0 协议
-	1路支持 SDIO 系统启动 ( SDIO0 )
20. PS/2 控制器
-	16 位可编程 5 us 时钟计数器，8 位可编程 60 us 时钟计数器
-	兼容第一套和第二套键盘扫描码
-	支持编码键盘和非编码键盘
-	支持二键式、三键式鼠标
21.	HPET
-	32 位计数器
-	支持 1 哥周期性中断
-	支持 2 哥非周期性中断
22. CAN
-	四路 CAN 接口
-	兼容 CAN 2.0 规范
23.	RTC
-	计时精确到 0.1 秒
-	可产生 3 个计时中断
-	支持定时开机功能
24. GPIO
-	155 位 GPIO 引脚，
-	128 路支持外部中断输入
-	与其他接口复用
25.	Watchdog
-	32 比特计数器及初始化寄存器
-	低功耗模式暂停功能
26.	温度传感器
-	温度观测，支持温度范围: 0 ~ 70 C
-	高低温中断
28.	中断控制器
-	支持软件设置中断
-	支持电平与边沿触发
-	支持中断屏蔽与使能
-	支持多种中断分发模式
28.	ACPI 功耗管理
-	处理器核动态频率电压调节
-	媒体处理器可关断
-	全芯片时钟门控
-	PHY 可关断
-	GMACO 可网络唤醒
-	来电可自动启动

## 地址空间

龙芯 2K0500 的地址空间分为 CPU 和DMA 两个视角: 所有 CPU 可访问的设备编址在 CPU 的地址空间上，成为 CPU 视角；可通过 DMA 直接访问系统内存的主设备所见到的空间为 DMA 视角。

每个视角对应的地址空间分配，可查看文档[龙芯 2K0500 处理器用户手册 V1.0](https://www.loongson.cn/uploads/images/2023042109171499358.%E9%BE%99%E8%8A%AF2K0500%E5%A4%84%E7%90%86%E5%99%A8%E7%94%A8%E6%88%B7%E6%89%8B%E5%86%8C_v1.0.pdf) 5.3 章节。

## 中断配置

龙芯 2K0500 芯片最多支持 64 个中断源，以统一方式进行管理，任意一个 IO 中断源可被配置为是否使能、触发方式、以及被路由的目标处理器核中断引脚。