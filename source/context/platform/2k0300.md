# 2k0300芯片

龙芯 2K0300 芯片，广泛应用于嵌入式系统领域。

具体请查看手册:[龙芯 2K0300 处理器用户手册 V1.01](https://www.loongson.cn/uploads/images/2025060909243029508.%E9%BE%99%E8%8A%AF2K0300%E5%A4%84%E7%90%86%E5%99%A8%E7%94%A8%E6%88%B7%E6%89%8B%E5%86%8C_V1.01.pdf)。

## 芯片参数

其基本性能参数如下。

:::{list-table} 
:widths: 20 50
:header-rows: 0

*	- 处理器核
	- 64 位双发射超标量 LA264 ，支持 LoongArch 指令系统
*	- 主频
	- 1 GHz
*	- 高速缓存
	- 32KB 一级指令缓存和 32KB 一级数据缓存，支持 ECC 校验；512KB 二级共享缓存，支持 ECC 校验
*	- 内存控制器
	- 16 位 DDR4-1600 控制器，支持 ECC 校验
*	- 高速 I/O
	- 2 个 USB2.0、2 个 GMAC、1 路 LCD 显示
*	- 封装
	- 12 mm × 12 mm FC-CSP 封装，286 个引脚
*	- 功耗管理
	- 支持处理器核时钟动态变频；支持主要模块时钟动态关闭
*	- 其它I/O
	- 1 个 I2S、4 个 CAN-FD、4 个 SPI、2 个 QSPI、2 个 eMMC、2 个 SDIO、1 个 LIO、8 通道 ADC、4 个 I2C、10 个 UART
*	- 其它 I/O
	- 4 个 PWM、3 组 TIMER、106 个 GPIO、RTC、HPET、JTAG 等
:::

## 芯片架构

龙芯 2K0300 芯片结构图如下。

```{image} ../../img/arch_2k0300.png
:alt: 2K0300 结构图
:class: bg-primary
:scale: 50 %
:align: center
```

## 芯片功能

1. 处理器核
-	64 位双发射 LA264 核
-	LoongArch 体系结构兼容
-	包括 1 个全流水的 64 位双精度浮点乘加部件
-	32KB 数据 Cache 和 32KB 的指令 Cache
-	512KB 共享二级 Cache
-	通过目录协议维护 I/O DMA 访问的 Cache 一致性
-	JTAG 支持
2. 内存接口
-	16 位 DDR4 控制器，支持 DDR4-1600
-	支持硬件 ECC
-	支持命令调度
3. 显示接口
-	1 路 DVO 显示输出
-	分辨率可支持 320×240～1920×1080@60Hz/24bit
4. USB 控制器
-	1 个独立的 USB2.0 的 HOST 端口
-	1 个独立的 OTG 端口，支持 HOST/DEVICE 模式
-	兼容 USB1.1、 USB2.0
-	内部 EHCI 控制和实现高速传输可达 480 Mbps
-	内部 OHCI 控制和实现全速和低速传输
-	低功耗管理
5. GMAC 控制器
-	两路 10/100/1000Mbps 自适应以太网 MAC
-	双网卡均兼容 IEEE 802.3
-	对外部 PHY 实现 RGMII/MII 接口
-	半双工/全双工自适应
-	Timestamp 功能
-	半双工时，支持碰撞检测与重发（CSMA/CD）协议
-	支持 CRC 校验码的自动生成与校验，支持前置符生成与删除
6. I2S
-	1 路 I2S 接口
-	支持单声道和立体声道音频数据
-	支持 DMA 传输模式
7. SPI
-	双缓冲接收器
-	极性和相位可编程的串行时钟
-	主模式支持（SPI0/1）
-	主从模式支持（SPI2/3），支持 DMA 传输模式（SPI2/3）
-	支持到 4 个的变长字节传输
-	支持系统启动（仅 SPI0 支持）
-	支持 QSPI 模式（仅 SPI0/1 支持）
-	支持标准读、连续地址读、快速读、双路 I/O 等 SPI Flash 读模式
8. UART
-	2 个全功能 UART 和流控 TXD,RXD,CTS, RTS, DSR,DTR,DCD, RI
-	最多 10 个 UART 接口，均支持 DMA 传输模式
-	两路全双工异步数据接收/发送
-	可编程的数据格式
-	16 位可编程时钟计数器
-	支持接收超时检测
-	带仲裁的多中断系统
9. I2C
-	履行双向同步串行协议
-	支持主从设备操作
-	能够支持多主设备的总线
-	支持 DMA 传输模式
-	总线的时钟频率可编程
-	可以产生开始/停止/应答等操作
-	能够对总线的状态进行探测
-	支持低速和快速模式
-	支持 7 位寻址和 10 位寻址
-	支持时钟延伸和等待状态
10. AD
-	支持 8 路 12 位 AD 电路采样
-	支持 DMA 传输模式
11. CAN
-	支持 4 路 CAN 接口，支持 CAN-FD
-	支持 DMA 传输模式
12. TIMER
-	3 组定时器 A/G/B-TIMER
-	ATIM/GTIM 支持输入捕获/PWM 输出，支持 DMA 传输模式
-	ATIM 支持 3 路互补 PWM 输出，GTIM 支持编码器/霍尔模式
13. PWM
-	32 位计数器
-	支持脉冲生成及捕获
-	4 路控制器
14. SDIO
-	2 路独立 SDIO 控制器(均可配置为 eMMC 模式)
-	1 路支持 SDIO 系统启动(SDIO0/eMMC0 支持启动)
15. LocalIO
-	1 路 LocalIO 总线，支持最大 32MB 空间 MEM 访问
-	支持 8/16 位数据宽度，双片选扩展
16. HPET
-	4 个 32 位计数器
-	支持 1 个周期性中断
-	支持 2 个非周期性中断
17. RTC
-	计时精确到 0.1 秒
-	可产生 3 个计时中断
18. GPIO
-	106 位复用 GPIO 引脚
-	支持外部中断输入
-	与其他接口复用，使用各个接口电压域
19. Watchdog
-	32 比特计数器及初始化寄存器
-	低功耗模式暂停功能
20. 温度传感器
-	温度观测
-	高低温中断
21. 中断控制器
-	支持软件设置中断
-	支持电平与边沿触发
-	支持中断屏蔽与使能
-	支持多种中断分发模式

## 地址空间

龙芯 2K0300 的地址空间根据系统应用不同，分为 LA264 处理器核、DMA 两个视角地址空间：
所有 LA264 处理器核可访问的设备地址在系统地址空间上，为LA264 视角；
可通过DMA 直接访问系统内存的设备所见到的空间为 DMA 视角。

每个视角下的可访问地址空间分布，可查看文档[龙芯 2K0300 处理器用户手册 V1.01](https://www.loongson.cn/uploads/images/2025060909243029508.%E9%BE%99%E8%8A%AF2K0300%E5%A4%84%E7%90%86%E5%99%A8%E7%94%A8%E6%88%B7%E6%89%8B%E5%86%8C_V1.01.pdf) 3.2 章节。

## 中断配置及路由

龙芯 2K0300 芯片中断分为传统、扩展中断方式。

传统中断方式最多支持 64 个中断源，以统一方式进行管理。任意一个 IO 中断源可以被配置为是否使能、触发的方式、以及被路由的目标处理器核中断脚。

传统中断相关配置寄存器都是以位的形式对相应的中断线进行控制。

扩展 IO 中断方式，则是将 2K0300 芯片中所有 IO 设备中断，全部映射至全新的扩展 IO 中断向量，并增加相应扩展中断使能、中断状态、中断清除及路由等功能。

该扩展 IO 中断向量最多支持 128 个 IO 设备，填补了传统 IO 中断方式仅 64 哥有限中断源的处理限制，提升了 IO 中断使用的灵活性。